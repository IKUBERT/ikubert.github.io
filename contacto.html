<script>
  // URL de la Versión 2
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwxChghvF_M6bCwR6crtV-YnjN3A_iWmjl6WeddZnsNv3zN926Hd8CkZcSIhhLiXlPxhA/exec'
  const form = document.getElementById('contact-form')
  const btn = document.getElementById('submit-btn')
  const msg = document.getElementById('response-msg')

  form.addEventListener('submit', e => {
    e.preventDefault()
    btn.disabled = true
    btn.innerText = 'ENVIANDO...'
    
    // Capturamos los datos del formulario
    fetch(scriptURL, { 
        method: 'POST', 
        body: new FormData(form),
        mode: 'no-cors' // Agregamos esto para evitar bloqueos de seguridad del navegador
    })
    .then(() => {
        // Con 'no-cors' no podemos leer la respuesta "Success", 
        // así que asumimos que llegó si no hay error.
        btn.style.display = 'none'
        msg.style.display = 'block'
        msg.innerText = '¡Mensaje enviado con éxito!'
        form.reset() // Limpia el formulario
    })
    .catch(error => {
        btn.disabled = false
        btn.innerText = 'ERROR AL ENVIAR'
        alert('Hubo un error técnico: ' + error.message)
        console.error('Error!', error.message)
    })
  })
</script>
