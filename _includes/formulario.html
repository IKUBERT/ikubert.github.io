<form name="google-sheet">
    <label style="display: block; margin-bottom: 5px; font-weight: 700; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Nombre / Empresa:</label>
    <input type="text" name="nombre" required style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">

    <label style="display: block; margin-bottom: 5px; font-weight: 700; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Email Corporativo:</label>
    <input type="email" name="email" required style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box;">

    <label style="display: block; margin-bottom: 5px; font-weight: 700; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Desafío Técnico / Mensaje:</label>
    <textarea name="mensaje" required style="width: 100%; padding: 12px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px; min-height: 120px; box-sizing: border-box;"></textarea>

    <button type="submit" id="submit-btn" style="background: #1a1a1a; color: #fff; padding: 15px 30px; border: none; text-transform: uppercase; font-weight: 700; letter-spacing: 2px; cursor: pointer; width: 100%; transition: 0.3s;">
        Enviar Consulta
    </button>
</form>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwsnV8CnvjTeIEW4rKL1Y1oq2chwdP3-J7uNVDIiG7o7t8Vjv6sXXFYBs7FfWB1RLKI2w/exec';
  const form = document.forms['google-sheet'];
  const btn = document.getElementById('submit-btn');

  form.addEventListener('submit', e => {
    e.preventDefault();
    btn.disabled = true;
    btn.innerText = "Procesando...";

    fetch(scriptURL, { method: 'POST', body: new FormData(form)})
      .then(response => {
          alert("¡Mensaje recibido! Nos pondremos en contacto a la brevedad.");
          form.reset();
          btn.disabled = false;
          btn.innerText = "Enviar Consulta";
      })
      .catch(error => {
          console.error('Error!', error.message);
          alert("Hubo un error. Por favor escribe a contact@ikubert.com");
          btn.disabled = false;
          btn.innerText = "Reintentar";
      });
  });
</script>
